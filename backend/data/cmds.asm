call main 
hlt

; let the chaos begin

; function 
main:
; ---------------------------------------------
push 1
; ---------------------------------------------
; popping variable bebra
pop [0+rax]
; ---------------------------------------------
; pushing function call param: bebra
push [0+rax]
; ---------------------------------------------
; switching namespace
push 1
push rax
add
pop rax
; calling func
call fak
; switching namespace
push 1
push rax
sub
pop rax
; ---------------------------------------------
; popping variable bebra
pop [0+rax]
; ---------------------------------------------
; printing variable bebra
push [0+rax] 
out
; ---------------------------------------------
; ---------------------------------------------
ret
; end of func

; ---------------------------------------------
; ---------------------------------------------
; ---------------------------------------------
; ---------------------------------------------
; ---------------------------------------------
; ---------------------------------------------
; function 
; poping function argument: schet
pop [0+rax]
; ---------------------------------------------
fak:
; ---------------------------------------------
; pushing variable schet
push [0+rax]
; ---------------------------------------------
push 1
; ---------------------------------------------
add
; ---------------------------------------------
; popping variable schet
pop [0+rax]
; ---------------------------------------------
; printing variable schet
push [0+rax] 
out
; ---------------------------------------------
; ---------------------------------------------
; if begin
; pushing variable schet
push [0+rax]
; ---------------------------------------------
push 15
; ---------------------------------------------
jne if_label0

; ---------------------------------------------
; if true
; returning the value from var: schet
push [0+rax]
; ---------------------------------------------
ret
; end of func

; ---------------------------------------------
; ---------------------------------------------
jmp else_label0

if_label0:
; if false
; pushing function call param: schet
push [0+rax]
; ---------------------------------------------
; switching namespace
push 1
push rax
add
pop rax
; calling func
call fak
; switching namespace
push 1
push rax
sub
pop rax
; ---------------------------------------------
; popping variable schet
pop [0+rax]
; ---------------------------------------------
; ---------------------------------------------

else_label0:
; ---------------------------------------------
; ---------------------------------------------
; ---------------------------------------------
; ---------------------------------------------
; ---------------------------------------------
; ---------------------------------------------
; ---------------------------------------------
; ---------------------------------------------
